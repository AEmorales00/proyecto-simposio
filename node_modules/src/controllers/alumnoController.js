const Alumno = require('../models/alumnoModel');

exports.getAllAlumnos = (req, res) => {
    const connection = req.app.get('connection'); // Obtén la conexión desde app.js
    const alumno = new Alumno(connection); // Pasa la conexión al modelo

    alumno.getAll((err, results) => {
        if (err) {
            console.error(err);
            res.status(500).send('Error al obtener los alumnos');
        } else {
            res.json(results);
        }
    });
};

exports.createAlumno = (req, res) => {
    const nuevoAlumno = req.body;
    const connection = req.app.get('connection'); // Obtén la conexión desde app.js
    const alumno = new Alumno(connection); // Pasa la conexión al modelo

    alumno.create(nuevoAlumno, (err, results) => {
        if (err) {
            console.error(err);
            res.status(500).send('Error al crear el alumno');
        } else {
            res.redirect('/'); // Redirige al formulario después de registrar
        }
    });
};

// Asegúrate de exportar las funciones
module.exports = exports;